<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>×œ×•×— ×‘×§×¨×”</title>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://js.puter.com/v2/"></script>
  <link rel="stylesheet" href="index.css" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/he.js"></script>

<script>
function CheckShabat() {
      if (new Date().getDay() != 5 || new Date().getDay() != 6)
        window.location.replace('https://itaymotivation.github.io/MediaPublisher/index.html');
  }

$(document).ready(()=>{
  Swal.fire({
    title: '×›× ×™×¡×” ×œ×—×©×‘×•×Ÿ',
    html:
      '<input type="email" id="swal-input-email" class="swal2-input" placeholder="××™××™×™×œ">' +
      '<input type="password" id="swal-input-password" class="swal2-input" placeholder="×¡×™×¡××”">',
    icon: 'info',
    confirmButtonText: '×”×ª×—×‘×¨',
    showCancelButton: true,
    cancelButtonText: '×‘×™×˜×•×œ',
    preConfirm: () => {
      const email = document.getElementById('swal-input-email').value;
      const password = document.getElementById('swal-input-password').value;

      if (!email || !password) {
        Swal.showValidationMessage('× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª');
      }

      return { email, password };
    }
  }).then((result) => {
    if (result.isConfirmed) {
      const { email, password } = result.value;
      console.log("âœ‰ï¸ ××™××™×™×œ:", email);
      console.log("ğŸ” ×¡×™×¡××”:", password);
      endpoint = "https://mediapublisherbackend.onrender.com/getTimings";
      const jsonToSend = {
        guid: crypto.randomUUID(),
        id: password,
        mail: email
      }
      fetch(endpoint, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(jsonToSend)
        })
        .then(async (response) => {
          const result = await response.json();
        })
    }
  });

});
</script>
</head>

<body>
 
    <h1>×œ×•×— ×‘×§×¨×”</h1>
      <div class="container">
    <h1>×œ×•×— ×ª×–××•× ×™×</h1>

    <div class="posts-container" id="postsContainer">
    <!-- ×¤×•×¡×˜×™× ×™×™×›× ×¡×• ×›××Ÿ -->
  </div>

  <script>
    const postArray = [
      {
        content: "fgh",
        filesLink: "AgACAgQAAyEGAASbaRWyAAPhaE7PoE-lNfXcuOIjlEUzUlplmqkAAie5MRvKHnRS_LnIrbzfq5QBAAMCAANtAAM2BA; AgACAgQAAyEGAASbaRWyAAPiaE7PoXKeQzTYO42NUfK8nEBo-20AAgy5MRvRmn1Slu4JrEuRuiMBAAMCAAN4AAM2BA",
        platforms: "telegram",
        publishDate: "15.6.2025",
        publishTime: "16:00",
        publisherId: 111,
        publisherMail: 111,
        timingId: "928018ca-8a80-4904-9024-f93ef7794048"
      },
      // ××¤×©×¨ ×œ×”×•×¡×™×£ ×›××Ÿ ×¢×•×“ ××•×‘×™×™×§×˜×™×
    ];

    const container = document.getElementById('postsContainer');

    postArray.forEach(post => {
      const card = document.createElement('div');
      card.className = 'post-card';
      card.setAttribute('data-id', post.timingId);

      const files = post.filesLink.split(';').map(file => file.trim()).filter(Boolean);
      const filesHTML = files.map((f, i) => `<a href="https://t.me/share/file?url=${encodeURIComponent(f)}" target="_blank">ğŸ“ ×§×•×‘×¥ ${i + 1}</a>`).join('<br>');

      card.innerHTML = `
        <div class="post-title">ğŸ—“ ×ª×–××•×Ÿ ×¤×¨×¡×•×</div>
        <div class="post-detail"><strong>×ª×•×›×Ÿ:</strong> ${post.content}</div>
        <div class="post-detail"><strong>×ª××¨×™×š:</strong> ${post.publishDate}</div>
        <div class="post-detail"><strong>×©×¢×”:</strong> ${post.publishTime}</div>
        <div class="post-detail"><strong>×¤×œ×˜×¤×•×¨××•×ª:</strong> ${post.platforms}</div>
        <div class="post-detail"><strong>××™×™×œ ××¤×¨×¡×:</strong> ${post.publisherMail}</div>
        <div class="post-files">${filesHTML}</div>
        <button class="delete-button" onclick="deletePost('${post.timingId}')">ğŸ—‘ï¸ ××—×™×§×ª ×ª×–××•×Ÿ</button>
      `;

      container.appendChild(card);
    });

    function deletePost(timingId) {
      Swal.fire({
        title: '×”×× ×œ××—×•×§ ××ª ×”×ª×–××•×Ÿ?',
        text: "×œ× ×ª×•×›×œ ×œ×©×—×–×¨ ××•×ª×• ×œ××—×¨ ××›×Ÿ!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: '×›×Ÿ, ××—×§!',
        cancelButtonText: '×‘×™×˜×•×œ'
      }).then((result) => {
        if (result.isConfirmed) {
          const card = document.querySelector(`[data-id="${timingId}"]`);
          if (card) card.remove();

          Swal.fire(
            '× ××—×§!',
            '×”×ª×–××•×Ÿ ×”×•×¡×¨ ×‘×”×¦×œ×—×”.',
            'success'
          );

          // ×›××Ÿ ×ª×•×›×œ ×’× ×œ×©×œ×•×— ×‘×§×©×ª DELETE ×œ×©×¨×ª ×× ×™×© API
        }
      });
    }
  </script>


</body>
</html>
